# Arduino Platform Configuration for nRF54L15 Bare-Metal Port
# Licensed under the Apache License 2.0

name=Seeed nRF54L15 (Bare-Metal)
version=1.1.3
category=ARM

# Python launcher used by upload helper (cross-platform)
tools.python3.cmd=python3
tools.python3.cmd.windows=py
tools.python3.cmd.macosx=python3
tools.python3.args=
tools.python3.args.windows=-3
tools.python3.args.macosx=

# Toolchain commands
compiler.exe.suffix=
compiler.exe.suffix.windows=.exe
compiler.path=
compiler.c.cmd=arm-none-eabi-gcc{compiler.exe.suffix}
compiler.cpp.cmd=arm-none-eabi-g++{compiler.exe.suffix}
compiler.S.cmd=arm-none-eabi-gcc{compiler.exe.suffix}
compiler.ar.cmd=arm-none-eabi-ar{compiler.exe.suffix}
compiler.objcopy.cmd=arm-none-eabi-objcopy{compiler.exe.suffix}
compiler.size.cmd=arm-none-eabi-size{compiler.exe.suffix}

# Compiler flags
compiler.c.flags=-std=gnu17 -mcpu=cortex-m33 -mthumb -mfloat-abi=soft -mfp16-format=ieee -Wall -Wextra -Os -g3 -ffunction-sections -fdata-sections
compiler.cpp.flags=-std=gnu++17 -mcpu=cortex-m33 -mthumb -mfloat-abi=soft -mfp16-format=ieee -Wall -Wextra -Os -g3 -ffunction-sections -fdata-sections -fno-rtti -fno-exceptions -fno-threadsafe-statics -fno-use-cxa-atexit -fno-sized-deallocation
compiler.S.flags=-mcpu=cortex-m33 -mthumb -mfloat-abi=soft -mfp16-format=ieee -x assembler-with-cpp
compiler.c.elf.flags=-mcpu=cortex-m33 -mthumb -mfloat-abi=soft -Wl,--gc-sections -Wl,-Map,{build.path}/{build.project_name}.map
compiler.ar.flags=rcs
compiler.ldflags=-Wl,-T{runtime.platform.path}/cores/nrf54l15/nrf54l15_linker_script.ld

compiler.c.extra_flags=-D__ZEPHYR__=1 -D__CORTEX_M33=1 -D__FPU_PRESENT=1 -I{build.variant.path}/zephyr_lib/include -I{build.variant.path}/zephyr_lib/include/generated -I{build.variant.path}/zephyr_lib/include/modules/cmsis_6 -I{build.variant.path}/zephyr_lib/include/modules/cmsis
compiler.cpp.extra_flags=-D__ZEPHYR__=1 -D__CORTEX_M33=1 -D__FPU_PRESENT=1 -I{build.variant.path}/zephyr_lib/include -I{build.variant.path}/zephyr_lib/include/generated -I{build.variant.path}/zephyr_lib/include/modules/cmsis_6 -I{build.variant.path}/zephyr_lib/include/modules/cmsis
compiler.S.extra_flags=-D__ZEPHYR__=1 -D__CORTEX_M33=1 -D__FPU_PRESENT=1 -I{build.variant.path}/zephyr_lib/include -I{build.variant.path}/zephyr_lib/include/generated -I{build.variant.path}/zephyr_lib/include/modules/cmsis_6 -I{build.variant.path}/zephyr_lib/include/modules/cmsis

# Build recipes
recipe.hooks.sketch.prebuild.1.pattern="{tools.python3.cmd}" {tools.python3.args} "{runtime.platform.path}/tools/build_zephyr_lib.py" --quiet --extra-conf "{build.zephyr_conf_radio}" --extra-conf "{build.zephyr_conf_bt_controller}" --extra-conf "{build.zephyr_conf_ble6}" --extra-dtc-overlay "{build.zephyr_dtc_overlay_cpu}" --extra-dtc-overlay "{build.zephyr_dtc_overlay_bt_controller}" --extra-dtc-overlay "{build.zephyr_dtc_overlay_radio}"

recipe.c.o.pattern="{compiler.path}{compiler.c.cmd}" {compiler.c.flags} -D__ZEPHYR__=1 -D__CORTEX_M33=1 -D__FPU_PRESENT=1 -I{build.variant.path}/zephyr_lib/include -I{build.variant.path}/zephyr_lib/include/generated -I{build.variant.path}/zephyr_lib/include/modules/cmsis_6 -I{build.variant.path}/zephyr_lib/include/modules/cmsis {build.extra_flags} {build.cpu_flags} {build.radio_cpu_flags} {build.rf_antenna_flags} {build.radio_profile_flags} {build.bt_controller_flags} {build.ble6_flags} {includes} -c "{source_file}" -o "{object_file}"
recipe.cpp.o.pattern="{compiler.path}{compiler.cpp.cmd}" {compiler.cpp.flags} -D__ZEPHYR__=1 -D__CORTEX_M33=1 -D__FPU_PRESENT=1 -I{build.variant.path}/zephyr_lib/include -I{build.variant.path}/zephyr_lib/include/generated -I{build.variant.path}/zephyr_lib/include/modules/cmsis_6 -I{build.variant.path}/zephyr_lib/include/modules/cmsis {build.extra_flags} {build.cpu_flags} {build.radio_cpu_flags} {build.rf_antenna_flags} {build.radio_profile_flags} {build.bt_controller_flags} {build.ble6_flags} {includes} -c "{source_file}" -o "{object_file}"
recipe.S.o.pattern="{compiler.path}{compiler.S.cmd}" {compiler.S.flags} -D__ZEPHYR__=1 -D__CORTEX_M33=1 -D__FPU_PRESENT=1 -I{build.variant.path}/zephyr_lib/include -I{build.variant.path}/zephyr_lib/include/generated -I{build.variant.path}/zephyr_lib/include/modules/cmsis_6 -I{build.variant.path}/zephyr_lib/include/modules/cmsis {build.extra_flags} {build.cpu_flags} {build.radio_cpu_flags} {build.rf_antenna_flags} {build.radio_profile_flags} {build.bt_controller_flags} {build.ble6_flags} {includes} -c "{source_file}" -o "{object_file}"
recipe.ar.pattern="{compiler.path}{compiler.ar.cmd}" {compiler.ar.flags} "{archive_file_path}" "{object_file}"
recipe.c.combine.pattern="{tools.python3.cmd}" {tools.python3.args} "{runtime.platform.path}/tools/link_zephyr_arduino.py" "{build.variant.path}" "{build.path}" "{build.project_name}" "{object_files}" "{archive_file_path}"
recipe.objcopy.hex.pattern="{compiler.path}{compiler.objcopy.cmd}" -O ihex "{build.path}/{build.project_name}.elf" "{build.path}/{build.project_name}.hex"
recipe.objcopy.bin.pattern="{compiler.path}{compiler.objcopy.cmd}" -O binary "{build.path}/{build.project_name}.elf" "{build.path}/{build.project_name}.bin"
recipe.size.pattern="{tools.python3.cmd}" {tools.python3.args} "{runtime.platform.path}/tools/report_size.py" "{compiler.path}{compiler.size.cmd}" "{build.path}/{build.project_name}.elf"
recipe.size.regex=^PROGRAM:([0-9]+)$
recipe.size.regex.data=^DATA:([0-9]+)$

# Upload tool
tools.nrf54upload.path={runtime.platform.path}/tools
tools.nrf54upload.cmd.path={tools.nrf54upload.path}/upload.py
tools.nrf54upload.upload.pattern="{tools.python3.cmd}" {tools.python3.args} "{tools.nrf54upload.cmd.path}" --hex "{build.path}/{build.project_name}.hex" --port "{serial.port}" --runner "{upload.runner}" --openocd-script "{upload.openocd_script}" --openocd-speed "{upload.openocd_speed}"
